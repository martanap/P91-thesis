% Define the experimental data

%list of results from bead assay in MTP:
%wtP91:
%t = [2;	3;	4;	5;	6;	7;	8;	9;	10;	11;	14;	24;	34;	44;	54;	64;	74;	84;	94;	104;	114;	124;	134;	164;	194;	224;	254;	284;	314;	344;	374;	404;	434;	464;	494;	524;	554;	584;	614;	644;	674;]
%P = (10^(-6)).*[0.601460096233615;	0.701012112161938;	0.804712128753941;	0.80056412809026;	0.879376140700183;	0.900116144018583;	0.941596150655384;	1.03285216525635;	1.06603617056579;	1.04529616724739;	1.09092417454787;	1.22780819644931;	1.65505226480836;	2.02837232453957;	2.44317239090758;	2.84138045462087;	3.2312925170068;	3.72075659532106;	4.20607267297163;	4.61672473867596;	5.14352082296333;	5.62468889995022;	5.97726895636303;	7.32122117139539;	8.56562137049942;	9.85564957690393;	11.0253857640617;	12.0789779326365;	13.1201260992202;	14.1571262651402;	15.0738344118135;	15.9449145511863;	16.6915546706487;	17.4547867927659;	18.2470549195288;	18.919031027045;	19.5163431226149;	19.956031192965;	20.565787290526;	20.980587356894;	21.304131408661];  % Corresponding product concentrations

%I211WL214V:
%t = [0;	1;	2;	3;	4;	5;	6;	7;	8;	9;	10;	11;	14;	24;	34;	44;	54;	64;	74;	84;	94;	104;	114;	124;	134;	164;	194;	224;	254;	284;	314;	344];  % Time points
%P = (10^(-6)).*[2.14036834245893;	4.99004479840717;	6.95619711299154;	8.55732536917206;	9.90957358553177;	11.0129417620707;	12.0540899286544;	12.9832420773187;	13.588850174216;	14.4557823129252;	15.2314584370333;	15.8370665339306;	17.5750788120126;	22.3245395719263;	27.3436203749793;	31.6533930645429;	35.8677617388419;	40.1692384270781;	44.0476190476191;	47.523643603783;	50.4313920690227;	53.9488966318235;	56.288369006139;	58.9264974282396;	61.3489298158288;	65.8121785299486;	69.4873071179691;	72.1171395387423;	73.3117637298822;	74.4192799070848;	74.6971959515514;	75;];  % Corresponding product concentrations

%I211W:
%t = [0;	1;	2;	3;	4;	5;	6;	7;	8;	9;	10;	11;	14;	24;	34;	44;	54;	64;	74;	84;	94;	104;	114;	124;	134;	164;	194;	224;	254;	284;	314;	344;	374;	404;	434;	464;	494;	524;	554;	584;	614;	644;	674;]
%P = (10^(-6)).*[1.5015762402522;	1.59283225485316;	1.77949228471877;	1.92882030861125;	2.04496432719429;	1.94956031192965;	2.09059233449477;	1.63431226148996;	1.80852828936453;	2.04496432719429;	2.15281234444998;	2.19429235108678;	2.40584038493446;	2.81649245063879;	3.46772855483657;	4.05259664841546;	4.74531275925004;	5.4836568773851;	6.2344449975112;	6.98938111830098;	7.7982412477186;	8.65687738510038;	9.58602953376472;	10.502737680438;	11.3613738178198;	13.7755102040816;	16.2809026049444;	18.7157789945246;	21.1713953874233;	23.5233117637299;	25.7466401194624;	27.9409324705492;	29.836568773851;	31.7861290857807;	33.4951053592169;	35.0589016094243;	36.7554338808694;	38.2818981251037;	39.4889663182346;	40.8951385432222;	42.1312427409988;	43.1433549029368;	44.2633150821304];  % Corresponding product concentrations

%I211E
%t = [0; 1;	2;	3;	4;	5;	6;	7;	8;	9;	10;	11;	14;	24;	34;	44;	54;	64;	74;	84;	94;	104;	114;	124;	134;	164;	194;	224;	254;	284;	314;	344;	374;	404;	434;	464;	494;	524;	554;	584;	614;	644;	674;]
%P=(10^(-6)).*[1.10751617720259;	1.49742823958852;	1.543056246889;	1.65505226480836;	1.750456280073;	1.73386427741828;	1.82512029201925;	1.81267629002821;	1.87904430064709;	1.95370831259333;	1.92882030861125;	1.87489629998341;	1.90393230462917;	1.93296830927493;	2.19844035175046;	2.3975443836071;	2.62153641944583;	2.75012444001991;	3.01559648249544;	3.24373651899784;	3.55898456943753;	3.8369006139041;	4.13140866102539;	4.4839887174382;	4.75775676124108;	5.63298490127758;	6.58702505392401;	7.57010121121619;	8.59880537580886;	9.51136552181848;	10.5068856811017;	11.5438858470217;	12.4771859963498;	13.4146341463415;	14.3106022896964;	15.2604944416791;	16.1979425916708;	17.1353907416625;	18.0230628836901;	18.8485150157624;	19.748631159781;	20.6528953044633;	21.4368674298988];

%I211R
%t = [8;	9;	10;	11;	14;	24;	34;	44;	54;	64;	74;	84;	94;	104;	114;	124;	134;	164;	194;	224;	254;	284;	314;	344;	374;	404;	434;	464;	494;	524;	554;	584;	614;	644;	674;]
%P=(10^(-6)).*[3.37232453957193;	3.47602455616393;	3.40550854488137;	3.57142857142857;	4.11896465903435;	4.629168740667;	5.57491289198606;	6.29251700680272;	7.32122117139539;	8.34992533598805;	9.38692550190808;	10.5317736850838;	11.6807698689232;	12.8048780487805;	13.9870582379293;	15.131906421105;	16.2850506056081;	19.4001991040319;	22.2955035672806;	25.2322880371661;	27.5344284055085;	30.0232288037166;	32.5286212045794;	34.7851335656214;	36.8052098888336;	38.7796582047453;	40.5093744814999;	42.181018748963;	43.827775012444;	45.0223992035839;	46.3456114152978;	47.4738675958188;	48.44449975112;	49.2492118798739;	50.0082960013274]


%list of results from simulation try1 (4 fractions) - correctedscript:
%order of variants: wtP91, I211E, I211R, I211WL214V, I211W
%t = [75; 135; 225; 315];
%P = [4.0091e-06; 6.4541e-06; 1.1854e-05; 1.7278e-05]
%P = [4.5388e-06; 7.6726e-06; 1.232e-05; 1.6334e-05]
%P = [1.6301e-05; 2.4203e-05; 3.7158e-05; 4.6003e-05]
%P = [6.7245e-05; 6.7498e-05; 6.7498e-05; 6.75e-05]
%P = [1.1305e-05; 1.751e-05; 2.945e-05; 3.92e-05]

%list of results from simulation try2 (5 fractions):
t = [45, 75, 135, 225, 315]
%P = [1.964e-06; 3.2673e-06; 6.8513e-06; 1.0049e-05; 1.3149e-05]
%P = [2.5624e-06; 4.1544e-06; 8.58e-06; 1.2575e-05; 1.6465e-05]
%P = [8.595e-06; 1.5397e-05; 2.348e-05; 3.6415e-05; 4.5998e-05]
%P = [5.8024e-05; 6.7225e-05; 6.75e-05; 6.75e-05; 6.75e-05]
%P = [5.8845e-06; 9.5094e-06; 1.8949e-05; 2.7073e-05; 3.4165e-05]



%Parameters specific to the assay:
E_init = 0.015 * 10^-6;  % Initial enzyme concentration
S_init = 0.9*75* 10^-6;  % Initial substrate concentration (correct based on background fluorescence value)

% Estimate k2 and k_1
[k2_estimate, k_1_estimate] = estimate_kinetic_parameters(t, P, S_init, E_init, S_init);

kcat_estimate = k2_estimate/60
Km_estimate = (k_1_estimate+k2_estimate)/((10^8)*60)

% Display the estimated parameters
disp("Estimated k2: " + k2_estimate);
disp("Estimated k_1: " + k_1_estimate);
disp("Estimated kcat: " + kcat_estimate);
disp("Estimated Km: " + Km_estimate);
disp("Estimated kcat/Km: " + kcat_estimate/Km_estimate);

