% Define the experimental data

%list of results from lysate assays:

%t = [0;	0.646666666666667;	1.29333333333333;	1.94;	2.58666666666667;	3.23333333333333;	3.88;	4.52666666666667;	5.17333333333333;	5.82;	6.46666666666667;	7.11333333333333;	7.76;	8.40666666666667;	9.05333333333333;	9.7;	10.3466666666667;	10.9933333333333;	11.64;	12.2866666666667;	12.9333333333333;	13.58;	14.2266666666667;	14.8733333333333;	15.52;	16.1666666666667;	16.8133333333333;	17.46;	18.1066666666667;	18.7533333333333;	19.4;	20.0466666666667;	20.6933333333333;	21.34;	21.985;	22.6333333333333;	23.2783333333333;	23.9266666666667;	24.5733333333333;	25.22;	25.8666666666667;	26.5133333333333;	27.16;	27.8066666666667;	28.4533333333333;	29.0983333333333;	29.7466666666667;	30.3933333333333;	31.04;	31.6866666666667;	32.3333333333333;	32.98;	33.6266666666667;	34.2733333333333;	34.92;	35.5666666666667;	36.2133333333333;	36.86;	37.5066666666667;	38.1533333333333;	38.8;	39.4466666666667;	40.0933333333333;	40.74;	41.3866666666667;	42.0333333333333;	42.68;	43.3266666666667;	43.9733333333333;	44.62;	45.2666666666667;	45.9133333333333;	46.56;	47.2066666666667;]

%wtP91:
%P = (10^(-6)).* [1.52030442597169;	1.97652212985846;	2.44411368231858;	2.96478319478769;	3.45006740058414;	3.90123006066053;	4.38398674455179;	4.81113794652887;	5.25471804088969;	5.73368344192316;	6.1481970343743;	6.61073354302404;	7.03788474500112;	7.47135475174118;	7.96674904515839;	8.42296674904516;	8.91456975960458;	9.25452145585262;	9.78782857784767;	10.1012412940912;	10.4702594922489;	10.8885643675579;	11.2601100876208;	11.7163277915075;	12.0310042687037;	12.5276623230735;	12.8802516288475;	13.1759716917547;	13.5298247584812;	13.9569759604583;	14.1667602785891;	14.5585261738935;	14.9338631768142;	15.4469501235677;	15.783110536958;	16.1622388227365;	16.3972983599191;	16.8408784542799;	17.2174792181532;	17.5574309144013;	17.8860087620759;	18.0060660525725;	18.213322848798;	18.5545383059987;	18.7643226241294;	19.0372949898899;	19.264771961357;	22.0172433161087;	22.406481689508;	22.5770894181083;	22.6276398562121;	22.846270501011;	23.2746854639407;	23.7940912154572;	24.0746461469333;	24.1706919793305;	24.6155358346439;	24.9011458099304;	25.0679622556729;	25.4470905414514;	25.4635194338351;	25.675831273871;	25.881824309144;	26.0916086272748;	26.1029824758481;	26.487165805437;	26.6792574702314;	26.833436306448;	27.026791732195;	27.2567962255673;	27.4943832846551;	27.8912042237699;	28.1148899123792;	28.3954448438553;]

%I211WL214V:
%P = (10^(-6)).* [4.23991799595596;	6.32638732869018;	7.77971242417434;	9.22039991013255;	10.5524039541676;	11.6607223095933;	12.8297011907437;	13.892524151876;	14.9212255672882;	15.9613008312739;	16.875;	17.8013367782521;	18.5469557402831;	19.3987306223321;	20.2618793529544;	21.0302460121321;	21.8226241294091;	22.4911536733318;	23.2734217029881;	23.7346944506852;	24.3046506403055;	24.9390586385082;	25.4572006290721;	26.1055099977533;	26.627443271175;	27.338940687486;	27.7092226465963;	28.0795046057066;	28.6431419905639;	29.010896427769;	29.3457930802067;	29.9144855088744;	30.3479555156145;	31.0291226690631;	31.4234160862727;	32.0338126263761;	32.252443271175;	32.8249269827005;	33.2672433161087;	33.556644574253;	34.2112727476971;	34.1544035048304;	34.1935800943608;	34.7673275668389;	34.801449112559;	35.3334924736014;	35.3600314536059;	38.1276679397888;	38.5927319703437;	38.8581217703887;	39.0299932599416;	38.9427937542125;	39.6707200629072;	40.2065547068075;	40.7461806335655;	40.7967310716693;	41.2820152774657;	41.6131206470456;	41.9619186699618;	41.9492810604359;	41.8355425747023;	42.2260447090541;	42.5824252976859;	42.6355032576949;	42.5495675129184;	43.0613906987194;	43.1283700292069;	43.1587002920692;	43.561840035947;	43.8967366883846;	44.213940687486;	44.5159795551561;	44.812963379016;	45;]

%I211W:
%P = (10^(-6)).* [0.489075488654235;	0.711497416310941;	0.846719838238598;	0.995843630644799;	1.11590092114132;	1.22205684115929;	1.33705908784543;	1.46090766119973;	1.56200853740732;	1.72629746124466;	1.83498090316783;	1.95630195461694;	2.06372163558751;	2.18630644798922;	2.34554032801618;	2.52120310042687;	2.66148056616491;	2.77774657380364;	2.96478319478769;	3.0620927881375;	3.16951246910807;	3.30726241294091;	3.46776005392047;	3.60424623680072;	3.69523702538755;	3.89743877780274;	4.00864974163109;	4.10343181307571;	4.2310716692878;	4.35871152549989;	4.41052572455628;	4.53563805886318;	4.69360817793754;	4.84273197034374;	4.99185576274994;	5.1030667265783;	5.17130981801842;	5.36466524376545;	5.46829364187823;	5.59087845427994;	5.76148618288025;	5.77033250954842;	5.82467423051;	6.04077735340373;	6.02434846102;	6.20253875533588;	6.22655021343518;	8.83748034149629;	8.97775780723433;	8.9613289148506;	9.07380363963154;	9.14457425297686;	9.28737924062009;	9.52243877780274;	9.62480341496293;	9.67409009211413;	9.86365423500337;	9.9811840035947;	10.0709110312289;	10.1492642102898;	10.151791732195;	10.2794315884071;	10.4386654684341;	10.4386654684341;	10.5031172770164;	10.6598236351382;	10.7520781846776;	10.7786171646821;	10.8291676027859;	10.9580712199506;	11.1248876656931;	11.2285160638059;	11.3713210514491;	11.4471467086048;]

%I211E
%P = (10^(-6)).* [0.313412716243541;	0.476437879128286;	0.535834643900247;	0.609132779150753;	0.666002022017524;	0.667265782970119;	0.708969894405752;	0.751937766793979;	0.793641878229611;	0.866940013480117;	0.902325320152775;	0.938974387778027;	0.98067849921366;	0.998371152549989;	1.09062570208942;	1.15760503257695;	1.23216692878005;	1.27387104021568;	1.3433778926084;	1.3699168726129;	1.44195124691081;	1.48997416310941;	1.53167827454505;	1.61003145360593;	1.64415299932599;	1.78063918220625;	1.78443046506403;	1.82739833745226;	1.8918501460346;	1.90701527746574;	1.9411368231858;	2.00558863176814;	2.04602898225118;	2.13070096607504;	2.1660862727477;	2.23812064704561;	2.25581330038194;	2.32405639182206;	2.38471691754662;	2.41757470231409;	2.49466412042238;	2.48708155470681;	2.46054257470231;	2.56164345090991;	2.57807234329364;	2.62483149853965;	2.6121938890137;	5.16246349135026;	5.20037631992811;	5.24081667041114;	5.26356436755785;	5.23197034374298;	5.33433498090317;	5.40763311615367;	5.46955740283082;	5.4746124466412;	5.54411929903392;	5.59340597618513;	5.61868119523703;	5.68313300381937;	5.63763760952595;	5.68818804762975;	5.74000224668614;	5.75516737811728;	5.79181644574253;	5.80950909907886;	5.82846551336778;	5.86132329813525;	5.88659851718715;	5.9497865648169;	5.98643563244215;	6.06605257245563;	6.11028420579645;	6.13303190294316;]

%I211R
%P = (10^(-6)).* [2.09531565940238;	3.31484497865648;	4.34607391597394;	5.34318130757133;	6.36303639631543;	7.25019658503707;	8.1398842956639;	9.05611098629521;	9.91420467310717;	10.8481240170748;	11.5040159514716;	12.3810660525725;	13.1671253650865;	13.9291732195012;	14.7215513367783;	15.6061840035947;	16.316417658953;	16.9482981352505;	17.7975454953943;	18.319478768816;	18.9210289822512;	19.523842956639;	20.1772073691305;	20.8773309368681;	21.3765165131431;	22.1183441923163;	22.5303302628623;	22.9688553134127;	23.6752976859133;	23.9950292069198;	24.4512469108066;	25.0060379689957;	25.5165973938441;	26.1901819815772;	26.7108514940463;	27.3376769265334;	27.5803190294316;	28.2627499438328;	28.7568804762975;	28.9919400134801;	29.6427769040665;	29.7122837564592;	29.856352505055;	30.3568018422826;	30.4604302403954;	31.1049483262188;	31.2995675129184;	34.1341833295889;	34.4614974163109;	34.5840822287126;	34.7635362839811;	34.8646371601887;	35.4143731745675;	36.2067512918445;	36.5719782071445;	36.5062626376095;	37.1608908110537;	37.4515558301505;	37.7485396540103;	38.0177207369131;	37.9671702988093;	38.2186587283756;	38.6546562570209;	38.8037800494271;	38.7456470456077;	39.0489496742305;	39.287800494271;	39.2397775780723;	39.4268141990564;	39.7933048753089;	40.2646877106268;	40.5932655583015;	40.8675016850146;	41.2441024488879;]


%list of results from bead assay in MTP:
%wtP91:
%t = [2;	3;	4;	5;	6;	7;	8;	9;	10;	11;	14;	24;	34;	44;	54;	64;	74;	84;	94;	104;	114;	124;	134;	164;	194;	224;	254;	284;	314;	344;	374;	404;	434;	464;	494;	524;	554;	584;	614;	644;	674;]
%P = (10^(-6)).*[0.601460096233615;	0.701012112161938;	0.804712128753941;	0.80056412809026;	0.879376140700183;	0.900116144018583;	0.941596150655384;	1.03285216525635;	1.06603617056579;	1.04529616724739;	1.09092417454787;	1.22780819644931;	1.65505226480836;	2.02837232453957;	2.44317239090758;	2.84138045462087;	3.2312925170068;	3.72075659532106;	4.20607267297163;	4.61672473867596;	5.14352082296333;	5.62468889995022;	5.97726895636303;	7.32122117139539;	8.56562137049942;	9.85564957690393;	11.0253857640617;	12.0789779326365;	13.1201260992202;	14.1571262651402;	15.0738344118135;	15.9449145511863;	16.6915546706487;	17.4547867927659;	18.2470549195288;	18.919031027045;	19.5163431226149;	19.956031192965;	20.565787290526;	20.980587356894;	21.304131408661];  % Corresponding product concentrations

%I211WL214V:
%t = [0;	1;	2;	3;	4;	5;	6;	7;	8;	9;	10;	11;	14;	24;	34;	44;	54;	64;	74;	84;	94;	104;	114;	124;	134;	164;	194;	224;	254;	284;	314;	344];  % Time points
%P = (10^(-6)).*[2.14036834245893;	4.99004479840717;	6.95619711299154;	8.55732536917206;	9.90957358553177;	11.0129417620707;	12.0540899286544;	12.9832420773187;	13.588850174216;	14.4557823129252;	15.2314584370333;	15.8370665339306;	17.5750788120126;	22.3245395719263;	27.3436203749793;	31.6533930645429;	35.8677617388419;	40.1692384270781;	44.0476190476191;	47.523643603783;	50.4313920690227;	53.9488966318235;	56.288369006139;	58.9264974282396;	61.3489298158288;	65.8121785299486;	69.4873071179691;	72.1171395387423;	73.3117637298822;	74.4192799070848;	74.6971959515514;	75;];  % Corresponding product concentrations

%I211W:
%t = [0;	1;	2;	3;	4;	5;	6;	7;	8;	9;	10;	11;	14;	24;	34;	44;	54;	64;	74;	84;	94;	104;	114;	124;	134;	164;	194;	224;	254;	284;	314;	344;	374;	404;	434;	464;	494;	524;	554;	584;	614;	644;	674;]
%P = (10^(-6)).*[1.5015762402522;	1.59283225485316;	1.77949228471877;	1.92882030861125;	2.04496432719429;	1.94956031192965;	2.09059233449477;	1.63431226148996;	1.80852828936453;	2.04496432719429;	2.15281234444998;	2.19429235108678;	2.40584038493446;	2.81649245063879;	3.46772855483657;	4.05259664841546;	4.74531275925004;	5.4836568773851;	6.2344449975112;	6.98938111830098;	7.7982412477186;	8.65687738510038;	9.58602953376472;	10.502737680438;	11.3613738178198;	13.7755102040816;	16.2809026049444;	18.7157789945246;	21.1713953874233;	23.5233117637299;	25.7466401194624;	27.9409324705492;	29.836568773851;	31.7861290857807;	33.4951053592169;	35.0589016094243;	36.7554338808694;	38.2818981251037;	39.4889663182346;	40.8951385432222;	42.1312427409988;	43.1433549029368;	44.2633150821304];  % Corresponding product concentrations

%I211E
%t = [0; 1;	2;	3;	4;	5;	6;	7;	8;	9;	10;	11;	14;	24;	34;	44;	54;	64;	74;	84;	94;	104;	114;	124;	134;	164;	194;	224;	254;	284;	314;	344;	374;	404;	434;	464;	494;	524;	554;	584;	614;	644;	674;]
%P=(10^(-6)).*[1.10751617720259;	1.49742823958852;	1.543056246889;	1.65505226480836;	1.750456280073;	1.73386427741828;	1.82512029201925;	1.81267629002821;	1.87904430064709;	1.95370831259333;	1.92882030861125;	1.87489629998341;	1.90393230462917;	1.93296830927493;	2.19844035175046;	2.3975443836071;	2.62153641944583;	2.75012444001991;	3.01559648249544;	3.24373651899784;	3.55898456943753;	3.8369006139041;	4.13140866102539;	4.4839887174382;	4.75775676124108;	5.63298490127758;	6.58702505392401;	7.57010121121619;	8.59880537580886;	9.51136552181848;	10.5068856811017;	11.5438858470217;	12.4771859963498;	13.4146341463415;	14.3106022896964;	15.2604944416791;	16.1979425916708;	17.1353907416625;	18.0230628836901;	18.8485150157624;	19.748631159781;	20.6528953044633;	21.4368674298988];

%I211R
%t = [8;	9;	10;	11;	14;	24;	34;	44;	54;	64;	74;	84;	94;	104;	114;	124;	134;	164;	194;	224;	254;	284;	314;	344;	374;	404;	434;	464;	494;	524;	554;	584;	614;	644;	674;]
%P=(10^(-6)).*[3.37232453957193;	3.47602455616393;	3.40550854488137;	3.57142857142857;	4.11896465903435;	4.629168740667;	5.57491289198606;	6.29251700680272;	7.32122117139539;	8.34992533598805;	9.38692550190808;	10.5317736850838;	11.6807698689232;	12.8048780487805;	13.9870582379293;	15.131906421105;	16.2850506056081;	19.4001991040319;	22.2955035672806;	25.2322880371661;	27.5344284055085;	30.0232288037166;	32.5286212045794;	34.7851335656214;	36.8052098888336;	38.7796582047453;	40.5093744814999;	42.181018748963;	43.827775012444;	45.0223992035839;	46.3456114152978;	47.4738675958188;	48.44449975112;	49.2492118798739;	50.0082960013274]


%Parameters specific to the assay:
E_init = 0.092 * 10^-6;  % Estimated enzyme concentration - see excel sheet from Tecan data for estimations
S_init = 0.9*45* 10^-6;  % Initial substrate concentration (correct based on background fluorescence value)

% Estimate k2 and k_1
[k2_estimate, k_1_estimate] = estimate_kinetic_parameters(t, P, S_init, E_init, S_init);

kcat_estimate = k2_estimate/60
Km_estimate = (k_1_estimate+k2_estimate)/((10^8)*60)

% Display the estimated parameters
disp("Estimated k2: " + k2_estimate);
disp("Estimated k_1: " + k_1_estimate);
disp("Estimated kcat: " + kcat_estimate);
disp("Estimated Km: " + Km_estimate);
disp("Estimated kcat/Km: " + kcat_estimate/Km_estimate);

